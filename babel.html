<!doctype html><html data-reactid=".r2mds8j9q8" data-react-checksum="-127097485"><head data-reactid=".r2mds8j9q8.0"><meta charset="utf-8" data-reactid=".r2mds8j9q8.0.0"><title data-reactid=".r2mds8j9q8.0.1">DžejEs - JavaScript pro web</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" data-reactid=".r2mds8j9q8.0.2"><link rel="stylesheet" type="text/css" href="main-68c297f04602afd849cc.css" data-reactid=".r2mds8j9q8.0.3"><link rel="icon" type="image/png" href="images/favicon-4b52c7e9cc28fdb9378fd1542994a946.png" data-reactid=".r2mds8j9q8.0.4"><base target="_blank" data-reactid=".r2mds8j9q8.0.5"></head><body data-reactid=".r2mds8j9q8.1"><div data-reactid=".r2mds8j9q8.1.0"><header class="Header" data-reactid=".r2mds8j9q8.1.0.0"><div class="NavBar" data-reactid=".r2mds8j9q8.1.0.0.0"><div class="NavBar-container" data-reactid=".r2mds8j9q8.1.0.0.0.0"><div class="NavBar-item" data-reactid=".r2mds8j9q8.1.0.0.0.0.0"><a class="NavBar-link" href="/" target="_self" data-reactid=".r2mds8j9q8.1.0.0.0.0.0.0">Úvod</a><a class="NavBar-link" href="https://twitter.com/vmiksu" data-reactid=".r2mds8j9q8.1.0.0.0.0.0.1">Twitter</a><a class="NavBar-link" href="https://github.com/tajo/javascript" data-reactid=".r2mds8j9q8.1.0.0.0.0.0.2">GitHub</a></div></div></div></header><div class="PageBody" data-reactid=".r2mds8j9q8.1.0.1"><div class="PageBody-container" data-reactid=".r2mds8j9q8.1.0.1.0"><div style="width:100%;" data-reactid=".r2mds8j9q8.1.0.1.0.0"><div style="width:100%;" data-reactid=".r2mds8j9q8.1.0.1.0.0.$0"><h1>JavaScript? Babel.<a id="javascript-babel-">&nbsp;</a></h1><p>JavaScript má oproti většině ostatních jazyků jedno specifikum. Je sám o sobě poměrně <strong>nepoužitelný</strong>. Na vině je především způsob, jakým dochází k uvádění jeho nových verzí. Jak si s tím úspěšně a elegantně poradit?</p>
<h2>JavaScript vs ECMAScript<a id="javascript-vs-ecmascript">&nbsp;</a></h2><p>JavaScript je pouze jednou z implementací standardu jménem <strong>ECMAScript</strong>. Díky obrovské popularitě JavaScriptu se ovšem tyto dva termíny často libovolně zaměňují. Existují však ještě další implementace jako JScript či ActionScript.</p>
<p>Ecma International od roku 1997 postupně vydává jednotlivé specifikace. Poslední stabilní verze je <strong><a href="http://wiki.ecmascript.org/lib/exe/fetch.php?id=start&amp;cache=cache&amp;media=resources:es5_errata_7-31-10.pdf">5.1 z roku 2011</a></strong>. Letos v létě pak přijde nová edice s pořadovým číslem 6 označovaná také kódem <strong>ES6</strong> či <strong>Harmony</strong>. K dispozici je už <a href="http://wiki.ecmascript.org/lib/exe/fetch.php?id=harmony%3Aspecification_drafts&amp;cache=cache&amp;media=harmony:ecma-262_6th_edition_final_draft_-04-14-15.pdf">finální draft</a>. Zároveň se nám rodí i verze číslo 7.</p>
<h2>Podpora prohlížečů<a id="podpora-prohl-e-">&nbsp;</a></h2><p>Asi vás nepřekvapí, že několik let stará specifikace 5.1 je dnes plně podporovaná napříč všemi prohlížeči. Co vás ovšem možná zaskočí je fakt, že výrobci prohlížečů <strong>nečekají s implementací</strong> nových specifikací na stabilní verze a tak už dnes například <strong>Chrome podporuje 45% funkcí Harmony</strong>, Firefox 69%, Internet Explorer 16%, Spartan 73% a Safari 20%. Aby toho nebylo málo, tak se v prohlížečích začínají objevovat i funkce z ECMAScriptu 7 a to navzdory tomu, že jsou teprve ve stádiu raného návrhu. Poměrně <strong>slušná anarchie</strong>.</p>
<h2>Co s tím?<a id="co-s-t-m-">&nbsp;</a></h2><p>My, tvůrci webových aplikací, musíme zajistit, aby naše stránky správně fungovaly ve všech běžně používaných prohlížečích. Jak si ale poradit s tím, že každý prohlížeč podporuje jiný set standardu Harmony? Nejjednodušším řešením je se zatím 6. verzi zcela vyhnout a <strong>používat pouze funkce z verze 5.1</strong>, která je již plně etablovaná. Nicméně tím se ocitnete v pozici malého dítěte, které v hračkárně toužebně pokukuje po mluvících a chodících robůtcích, zatímco doma si ještě několik let bude muset hrát s klacky a kameny. Předchozí příklad je samozřejmě nadsázka. Tak propastný rozdíl mezi verzemi zase není. Nicméně nebojte, existují lepší řešení.</p>
<h2>Shimujeme<a id="shimujeme">&nbsp;</a></h2><p>ES6 přináší dva typy novinek. Tou první jsou <strong>nové objekty a funkce</strong> na již existujících objektech. K těm si můžeme dopomoci jednoduše tím, že k projektu připojíme kusy kódu nazývané <a href="https://github.com/es-shims">shimy a polyfilly</a>. Ty pak detekují chybějící či odlišné API jednotlivých prohlížečů a následně je doplní a sjednotí. V budoucnu, až budou prohlížeče daný standard plně podporovat, můžeme tyto knihovny úplně odstranit.</p>
<h2>Kompilujeme<a id="kompilujeme">&nbsp;</a></h2><p>Druhou novinkou je nová syntax. V ES6 nám například přibyla nová klíčová slova jako <code>class</code>, <code>extends</code>, <code>let</code> či <code>import</code>. Tady si bohužel pouze s připojenou knihovnou už nevystačíme. Musíme použít <strong>program - kompilátor</strong>, který náš kód přeloží do starší plně podporované verze. V našem případě ES5. Navíc vyřeší i ony nové objekty a funkce z předchozí kapitoly (někdy ale bude i tak potřeba přidat polyfill). I zde platí, že v budoucnu budeme moct kompilátor z procesu úplně vynechat a náš kód bude v prohlížečích fungovat bez dodatečných úprav.</p>
<h2>V budoucnu?<a id="v-budoucnu-">&nbsp;</a></h2><p>Problém ovšem je, že jakmile budou prohlížeče plně podporovat ES6, tak tu budeme mít finální specifikaci ES7 a mlsně pokukovat po ES8. Prakticky to znamená jediné. <strong>Samotný JavaScript nikdy používat nemůžeme</strong>, pokud nechceme být neustále 4 roky pozadu. Nejlepším řešením je tedy vždy používat jazyk kompilovaný do JavaScriptu.</p>
<h2>Kompilátory<a id="kompil-tory">&nbsp;</a></h2><p>Nových jazyků a kompilátorů existuje celá řada. Dají se rozdělit do 2 základních kategorií. Tou první jsou zcela nové jazyky, které mají úplně odlišnou syntax a nemůžeme je tedy použít na vylepšení již hotových projektů. Jde například o populární <a href="http://coffeescript.org">CoffeeScript</a>, <a href="http://www.purescript.org">PureScript</a>, <a href="https://github.com/clojure/clojurescript">ClojureScript</a> či <a href="https://www.dartlang.org">Dart</a> (ten se snažil dokonce úplně emancipovat od JS ale neúspěšně). Druhou kategorií jsou jazyky, které současný JavaScript pouze rozšiřují a snaží se více či méně zachovat dopřednou kompatibilitu. Jde třeba o <a href="http://www.typescriptlang.org">TypeScript</a>, <a href="https://github.com/google/traceur-compiler">Traceur</a> či <a href="https://babeljs.io">Babel</a>. Vzájemným porovnáváním by se dalo popsat několik dalších stránek, proto ho nechávám na každém z vás. Dále se budu věnovat pouze poslednímu jmenovanému.</p>
<h2>Babel<a id="babel">&nbsp;</a></h2><p>Babel nedávno vznikl přejmenováním z <strong>6to5</strong>, rychle se dostal na špičku popularity a získává stále větší momentum. <strong>Proč je úspěšný?</strong> Hlavním důvodem je jednoduše <a href="https://kangax.github.io/compat-table/es6/">nejširší podpora ES6 (77%) i ES7 (61%)</a>. Plně integruje <strong>JSX a React</strong> (taková ta podivnost, kdy píšete HTML tagy přímo do těla JavaScriptových funkcí). Skvěle si rozumí s editory a různými nástroji.</p>
<p class="pic-container" style="max-width:250px">
  <img src="images/babel-d9f70b85777d74bc12be9dccf20a05a7.jpg" class="pic" title="Babel - nová generace JavaScriptu" />
</p>

<p>Používají ho už dnes firmy jako <strong>Facebook, Yahoo, Netflix, Mozilla a Evernote</strong>. Můžete ho nasadit na serverovém prostředí <strong>node.js</strong>. Je to ale stále onen čistý JavaScript, takže s ním můžete bez problémů zkompilovat i svoje stávající projekty a s ES6 začít postupně.</p>
<h2>Co tedy ES6 přináší?<a id="co-tedy-es6-p-in-">&nbsp;</a></h2><p>Je toho spousta. Zmíním jenom pár těch nejzásadnějších věcí. Bylo by asi zbytečné kompletně překládat <a href="https://babeljs.io/docs/learn-es6/">tuto povedenou dokumentaci</a> (ukázky kódu jsou zkopírované z této dokumentace).</p>
<h3>Třídy<a id="t-dy">&nbsp;</a></h3><p>Rozlučte se s <code>prototype</code>. Máme tu novou hezčí syntax, která podporuje prototypovou <strong>dědičnost</strong>, volání rodičovské metody, statické metody či <strong>konstruktory</strong>.</p>
<code class="codeBlock"><span class="token keyword" >class</span> <span class="token class-name" >SkinnedMesh</span> <span class="token keyword" >extends</span> <span class="token class-name" >THREE<span class="token punctuation" >.</span>Mesh</span> <span class="token punctuation" >{</span>
  <span class="token function" >constructor<span class="token punctuation" >(</span></span>geometry<span class="token punctuation" >,</span> materials<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token function" >super<span class="token punctuation" >(</span></span>geometry<span class="token punctuation" >,</span> materials<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token var" >this</span><span class="token punctuation" >.</span>idMatrix <span class="token operator" >=</span> <span class="token qualifier" >Skinned</span><span class="token qualifier" >Mesh</span><span class="token punctuation" >.</span><span class="token function" >defaultMatrix<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token var" >this</span><span class="token punctuation" >.</span>bones <span class="token operator" >=</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >;</span>
    <span class="token var" >this</span><span class="token punctuation" >.</span>boneMatrices <span class="token operator" >=</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >;</span>
    <span class="token comment" spellcheck="true">//...
</span>  <span class="token punctuation" >}</span>
  <span class="token function" >update<span class="token punctuation" >(</span></span>camera<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token comment" spellcheck="true">//...
</span>    <span class="token keyword" >super</span><span class="token punctuation" >.</span><span class="token function" >update<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token keyword" >static</span> <span class="token function" >defaultMatrix<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token keyword" >new</span> <span class="token class-name" >THREE<span class="token punctuation" >.</span>Matrix4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span></code><h3>Let a const<a id="let-a-const">&nbsp;</a></h3><p>Rozlučte se s <code>var</code>. Máme tu <code>let</code>. Oproti <code>var</code> omezuje působnost proměnné na nejbližší blok. Dále také přibylo klíčové slovo <code>const</code> pro konstanty.</p>
<code class="codeBlock"><span class="token block-keyword" >function</span> <span class="token function" >f<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >{</span>
    <span class="token keyword" >let</span> x<span class="token punctuation" >;</span>
    <span class="token punctuation" >{</span>
      <span class="token comment" spellcheck="true">// platnost pouze v tomto bloku
</span>      <span class="token keyword" >const</span> x <span class="token operator" >=</span> <span class="token string" >"sneaky"</span><span class="token punctuation" >;</span>
      <span class="token comment" spellcheck="true">// chyba, nemůžeme měnit konstantu
</span>      x <span class="token operator" >=</span> <span class="token string" >"foo"</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span>
    <span class="token comment" spellcheck="true">// chyba, nemůžeme opět deklarovat x ve stejném bloku
</span>    <span class="token keyword" >let</span> x <span class="token operator" >=</span> <span class="token string" >"inner"</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span></code><h3>Moduly<a id="moduly">&nbsp;</a></h3><p>Nová syntax sjednocující definici a nahrávání modulů. Nepostradatelná zbraň pro <strong>rozdělení kódu do mnoha modulů a souborů</strong>. Můžete si následně vybrat formát, do kterého má Babel ES6 moduly přeložit. V nabídce je <strong>Common.js</strong>, <strong>AMD</strong>, System a UMD. Dokonce si můžete vymyslet i formát vlastní. Nástroje jako <strong>browserify</strong> či <strong>webpack</strong> pak tyto závislosti za vás vyřeší a sestaví jeden výstupní soubor.</p>
<p>Ze souboru můžeme <strong>exportovat funkce</strong>, <strong>objekty</strong> i <strong>proměnné</strong> pomocí klíčového slova <code>export</code>.</p>
<code class="codeBlock"><span class="token comment" spellcheck="true">// lib/math.js
</span><span class="token keyword" >export</span> <span class="token block-keyword" >function</span> <span class="token function" >sum<span class="token punctuation" >(</span></span>x<span class="token punctuation" >,</span> y<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> x <span class="token operator" >+</span> y<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
<span class="token keyword" >export</span> <span class="token keyword" >var</span> pi <span class="token operator" >=</span> <span class="token number" >3.141593</span><span class="token punctuation" >;</span></code><p>V jiném souboru si je pak můžeme <strong>importovat</strong> pomocí klíčových slov <code>import</code> a <code>from</code>. <code>*</code> naimportuje vše.</p>
<code class="codeBlock"><span class="token comment" spellcheck="true">// app.js
</span><span class="token keyword" >import</span> <span class="token operator" >*</span> as math from <span class="token string" >"lib/math"</span><span class="token punctuation" >;</span>
<span class="token function" >alert<span class="token punctuation" >(</span></span><span class="token string" >"2π = "</span> <span class="token operator" >+</span> math<span class="token punctuation" >.</span><span class="token function" >sum<span class="token punctuation" >(</span></span>math<span class="token punctuation" >.</span>pi<span class="token punctuation" >,</span> math<span class="token punctuation" >.</span>pi<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Můžeme si ale i vybrat, <strong>co přesně</strong> chceme naimportovat pomocí <code>{}</code>.</p>
<code class="codeBlock"><span class="token comment" spellcheck="true">// otherApp.js
</span><span class="token keyword" >import</span> <span class="token punctuation" >{</span>sum<span class="token punctuation" >,</span> pi<span class="token punctuation" >}</span> from <span class="token string" >"lib/math"</span><span class="token punctuation" >;</span>
<span class="token function" >alert<span class="token punctuation" >(</span></span><span class="token string" >"2π = "</span> <span class="token operator" >+</span> <span class="token function" >sum<span class="token punctuation" >(</span></span>pi<span class="token punctuation" >,</span> pi<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Specialitou je pak klíčové slovo <code>default</code>.</p>
<code class="codeBlock"><span class="token comment" spellcheck="true">// lib/mathplusplus.js
</span><span class="token keyword" >export</span> <span class="token operator" >*</span> from <span class="token string" >"lib/math"</span><span class="token punctuation" >;</span>
<span class="token keyword" >export</span> <span class="token keyword" >var</span> e <span class="token operator" >=</span> <span class="token number" >2.71828182846</span><span class="token punctuation" >;</span>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token block-keyword" >function</span><span class="token punctuation" >(</span>x<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token qualifier" >Math</span><span class="token punctuation" >.</span><span class="token function" >exp<span class="token punctuation" >(</span></span>x<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span></code><p>V cílovém souboru si pak můžeme <strong>default import</strong> pojmenovat zcela dle své vůle (zde <code>exp</code>). Současně můžeme i nadále importovat ostatní funkce, objekty a proměnné.</p>
<code class="codeBlock"><span class="token comment" spellcheck="true">// app.js
</span><span class="token keyword" >import</span> exp<span class="token punctuation" >,</span> <span class="token punctuation" >{</span>pi<span class="token punctuation" >,</span> e<span class="token punctuation" >}</span> from <span class="token string" >"lib/mathplusplus"</span><span class="token punctuation" >;</span>
<span class="token function" >alert<span class="token punctuation" >(</span></span><span class="token string" >"2π = "</span> <span class="token operator" >+</span> <span class="token function" >exp<span class="token punctuation" >(</span></span>pi<span class="token punctuation" >,</span> e<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Pokud máte nějaké otázky ohledně ES6 modulů (a věřím, že jich určitě bude spousta), koukněte se na pěkný přehled <a href="http://www.2ality.com/2014/09/es6-modules-final.html">sem</a>.</p>
<h3>Ostatní<a id="ostatn-">&nbsp;</a></h3><p>Velmi užitečné jsou také <strong>defaultní hodnoty</strong> pro argumenty funkcí, <strong>šablony</strong> pro řetězce (aneb už není potřeba zběsile používat <code>+</code> pro spojování řetězců a proměnných) či <strong>desctructuring</strong>. Pro více detailů navštivte <a href="https://babeljs.io/docs/learn-es6">dokumentaci</a>.</p>
<h2>Závěrem<a id="z-v-rem">&nbsp;</a></h2><p>JavaScript už dávno není pouze doplňkovou hračkou v prohlížečích, ale začíná nám ovládat i ostatní platformy. Velké firmy do něj investují nemálo peněz a jeho vývoj tak probíhá překotným tempem. Díky tomu pak vznikají špičkové nástroje jako je Babel. To co na první pohled vypadá jako divoká džungle, tak nakonec příspívá k pružnějšímu vývoji, nutí výrobce prohlížečů rychleji implementovat nové funkce a programátor tím přesto nemusí trpět. Co si tedy z článku odnést? Jednoduché ponaučení! Vždy si přidejte Babel do svého vývojářského procesu a užívejte si budoucnost už dnes. <strong>JavaScript je mrtev, ať žije Babel!</strong></p>
</div></div></div></div><footer data-reactid=".r2mds8j9q8.1.0.2"><div class="links" data-reactid=".r2mds8j9q8.1.0.2.0"><div style="float:right;" data-reactid=".r2mds8j9q8.1.0.2.0.1"><a href="nastroje.html" target="_self" data-reactid=".r2mds8j9q8.1.0.2.0.1.0">Nástroje</a><span data-reactid=".r2mds8j9q8.1.0.2.0.1.1">▶</span><span data-reactid=".r2mds8j9q8.1.0.2.0.1.2"> </span></div></div><div class="Footer" data-reactid=".r2mds8j9q8.1.0.2.1"><span data-reactid=".r2mds8j9q8.1.0.2.1.0">Diskutujte prostřednictvím </span><a href="https://github.com/tajo/javascript/issues" data-reactid=".r2mds8j9q8.1.0.2.1.1">issues</a><span data-reactid=".r2mds8j9q8.1.0.2.1.2">.</span><br data-reactid=".r2mds8j9q8.1.0.2.1.3"><span data-reactid=".r2mds8j9q8.1.0.2.1.4">Vylepšete článek </span><a href="https://github.com/tajo/javascript/pulls" data-reactid=".r2mds8j9q8.1.0.2.1.5">pull requestem</a><span data-reactid=".r2mds8j9q8.1.0.2.1.6">.</span><br data-reactid=".r2mds8j9q8.1.0.2.1.7"><span data-reactid=".r2mds8j9q8.1.0.2.1.8">Sledujte na </span><a href="https://twitter.com/vmiksu" data-reactid=".r2mds8j9q8.1.0.2.1.9">twitteru</a><span data-reactid=".r2mds8j9q8.1.0.2.1.a">.</span><br data-reactid=".r2mds8j9q8.1.0.2.1.b"><b data-reactid=".r2mds8j9q8.1.0.2.1.c">Sdílejte!</b></div></footer></div><script data-reactid=".r2mds8j9q8.1.1">window.INITIAL_PROPS = {"location":"babel.html","devMode":false,"files":{"main.css":"main-68c297f04602afd849cc.css","main.js":"main-68c297f04602afd849cc.js"}};
</script><script src="main-68c297f04602afd849cc.js" data-reactid=".r2mds8j9q8.1.2"></script><div data-reactid=".r2mds8j9q8.1.3">
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-63660429-1', 'auto');
          ga('send', 'pageview');
        </script>
      </div></body></html>